<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Prompt Assistant - Console Debug</title>
    <style>
        body { 
            font-family: 'Consolas', monospace; 
            background: #1a1a1a; 
            color: #00ff00; 
            padding: 20px;
            margin: 0;
        }
        .debug-container {
            max-width: 800px;
            margin: 0 auto;
        }
        .log-section {
            background: #000;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        .log-item {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid;
        }
        .log-success { border-left-color: #00ff00; color: #00ff00; }
        .log-warning { border-left-color: #ffaa00; color: #ffaa00; }
        .log-error { border-left-color: #ff0000; color: #ff0000; }
        .log-info { border-left-color: #0088ff; color: #0088ff; }
        button {
            background: #007acc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #005fa3; }
        #realConsole {
            background: #000;
            color: #fff;
            min-height: 200px;
            overflow-y: auto;
            padding: 10px;
            border: 1px solid #333;
            border-radius: 5px;
            white-space: pre-wrap;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="debug-container">
        <h1>üîç AI Prompt Assistant - Console Debug Tool</h1>
        
        <div class="log-section">
            <h2>üìä Tr·∫°ng th√°i hi·ªán t·∫°i</h2>
            <div id="currentStatus">ƒêang ki·ªÉm tra...</div>
        </div>

        <div class="log-section">
            <h2>üß™ Test ch·ª©c nƒÉng</h2>
            <button onclick="testOpenAIConnection()">Test OpenAI Connection</button>
            <button onclick="testAPIKey()">Validate API Key</button>
            <button onclick="showConfig()">Show Config</button>
            <button onclick="clearLogs()">Clear Logs</button>
        </div>

        <div class="log-section">
            <h2>üìã Console Logs</h2>
            <div id="realConsole"></div>
        </div>

        <div class="log-section">
            <h2>‚ö° Quick Actions</h2>
            <button onclick="openMainApp()">M·ªü AI Prompt Assistant</button>
            <button onclick="reloadPage()">Reload Page</button>
        </div>
    </div>

    <script>
        // Intercept console logs v√† hi·ªÉn th·ªã
        const originalLog = console.log;
        const originalWarn = console.warn; 
        const originalError = console.error;
        const logContainer = document.getElementById('realConsole');

        function addLogToDisplay(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logLine = `[${timestamp}] ${type.toUpperCase()}: ${message}\n`;
            logContainer.textContent += logLine;
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        console.log = function(...args) {
            originalLog.apply(console, args);
            addLogToDisplay(args.join(' '), 'info');
        };

        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addLogToDisplay(args.join(' '), 'warning');
        };

        console.error = function(...args) {
            originalError.apply(console, args);
            addLogToDisplay(args.join(' '), 'error');
        };

        // Load main app script ƒë·ªÉ test
        function loadMainAppScript() {
            const script = document.createElement('script');
            script.src = './script.js';
            script.onload = function() {
                console.log('‚úÖ Script ƒë√£ ƒë∆∞·ª£c load th√†nh c√¥ng');
                updateStatus();
            };
            script.onerror = function() {
                console.error('‚ùå Kh√¥ng th·ªÉ load script.js');
                updateStatus('error');
            };
            document.head.appendChild(script);
        }

        function updateStatus(status = 'checking') {
            const statusDiv = document.getElementById('currentStatus');
            const now = new Date().toLocaleTimeString();
            
            if (status === 'checking') {
                statusDiv.innerHTML = `<div class="log-info">üîÑ [${now}] ƒêang ki·ªÉm tra tr·∫°ng th√°i...</div>`;
            } else if (status === 'error') {
                statusDiv.innerHTML = `<div class="log-error">‚ùå [${now}] C√≥ l·ªói x·∫£y ra khi load script</div>`;
            } else {
                // Check if main functions exist
                if (typeof validateOpenAIApiKey === 'function') {
                    const isValid = validateOpenAIApiKey();
                    if (isValid) {
                        statusDiv.innerHTML = `<div class="log-success">‚úÖ [${now}] OpenAI API Key h·ª£p l·ªá - S·∫µn s√†ng s·ª≠ d·ª•ng</div>`;
                    } else {
                        statusDiv.innerHTML = `<div class="log-warning">‚ö†Ô∏è [${now}] OpenAI API Key kh√¥ng h·ª£p l·ªá - Ch·∫ø ƒë·ªô Demo</div>`;
                    }
                } else {
                    statusDiv.innerHTML = `<div class="log-warning">‚ö†Ô∏è [${now}] Ch∆∞a load ƒë∆∞·ª£c functions ch√≠nh</div>`;
                }
            }
        }

        async function testOpenAIConnection() {
            console.log('üîç ƒêang test k·∫øt n·ªëi OpenAI...');
            
            if (typeof testOpenAIConnection === 'undefined') {
                console.error('‚ùå Function testOpenAIConnection kh√¥ng t·ªìn t·∫°i');
                return;
            }
            
            try {
                const result = await testOpenAIConnection();
                if (result) {
                    console.log('‚úÖ K·∫øt n·ªëi OpenAI th√†nh c√¥ng!');
                } else {
                    console.warn('‚ö†Ô∏è K·∫øt n·ªëi OpenAI th·∫•t b·∫°i');
                }
            } catch (error) {
                console.error('‚ùå L·ªói test connection:', error.message);
            }
        }

        function testAPIKey() {
            console.log('üîë ƒêang validate API key...');
            
            if (typeof validateOpenAIApiKey === 'function') {
                const isValid = validateOpenAIApiKey();
                console.log(`API Key validation: ${isValid ? '‚úÖ Valid' : '‚ùå Invalid'}`);
                
                if (typeof CONFIG !== 'undefined') {
                    const keyPreview = CONFIG.OPENAI_API_KEY ? 
                        CONFIG.OPENAI_API_KEY.substring(0, 10) + '...' : 
                        'Not configured';
                    console.log(`API Key preview: ${keyPreview}`);
                }
            } else {
                console.error('‚ùå Function validateOpenAIApiKey kh√¥ng t·ªìn t·∫°i');
            }
        }

        function showConfig() {
            console.log('‚öôÔ∏è Configuration:');
            if (typeof CONFIG !== 'undefined') {
                console.log('- Version:', CONFIG.VERSION);
                console.log('- Model:', CONFIG.OPENAI_MODEL);
                console.log('- Max Tokens:', CONFIG.MAX_TOKENS);
                console.log('- Temperature:', CONFIG.TEMPERATURE);
                console.log('- API URL:', CONFIG.OPENAI_API_URL);
            } else {
                console.error('‚ùå CONFIG object kh√¥ng t·ªìn t·∫°i');
            }
        }

        function clearLogs() {
            logContainer.textContent = '';
            console.log('üßπ Console logs ƒë√£ ƒë∆∞·ª£c x√≥a');
        }

        function openMainApp() {
            window.open('./index.html', '_blank');
        }

        function reloadPage() {
            window.location.reload();
        }

        // Initialize
        window.addEventListener('load', function() {
            console.log('üöÄ Debug Console ƒë√£ s·∫µn s√†ng');
            loadMainAppScript();
        });
    </script>
</body>
</html>
